# Certificate Specification

## Overview
This document defines the structure and validation requirements for certificates generated by the PCC-NIUC system.

## Certificate Schema (certificate.json)

### Required Fields

```json
{
  "version": "1.0",
  "timestamp": "2024-01-01T00:00:00Z",
  "certificate_id": "unique-identifier",
  "computation_hash": "sha256-hash-of-computation",
  "input_hash": "sha256-hash-of-inputs",
  "output_hash": "sha256-hash-of-outputs",
  "policy_version": "policy-version-string",
  "verification_data": {
    "proof_type": "zk-snark|attestation|signature",
    "proof_data": "base64-encoded-proof",
    "public_parameters": {}
  },
  "metadata": {
    "runtime_environment": "environment-description",
    "security_level": "high|medium|low",
    "compliance_flags": []
  },
  "signatures": [
    {
      "signer": "entity-identifier",
      "algorithm": "signature-algorithm",
      "signature": "base64-encoded-signature"
    }
  ]
}
```

### Field Descriptions

- **version**: Schema version for compatibility
- **timestamp**: Certificate generation time (ISO 8601)
- **certificate_id**: Unique identifier for this certificate
- **computation_hash**: Cryptographic hash of the computation code
- **input_hash**: Hash of input data (may be redacted for privacy)
- **output_hash**: Hash of computation output
- **policy_version**: Version of security policy applied
- **verification_data**: Cryptographic proofs for verification
- **metadata**: Additional context and compliance information
- **signatures**: Digital signatures from authorized entities

### Validation Rules

1. **Structural Validation**
   - All required fields must be present
   - Field types must match specification
   - Timestamps must be valid ISO 8601 format

2. **Cryptographic Validation**
   - All hashes must be valid SHA-256
   - Signatures must verify against known public keys
   - Proofs must validate according to proof type

3. **Semantic Validation**
   - Computation must comply with specified policy
   - Security level must be appropriate for data sensitivity
   - Compliance flags must be consistent

## Certificate Verification Process

1. **Parse Certificate**: Validate JSON structure
2. **Verify Signatures**: Check all digital signatures
3. **Validate Proofs**: Verify cryptographic proofs
4. **Check Policy Compliance**: Ensure policy adherence
5. **Verify Freshness**: Check timestamp and expiration
6. **Cross-Reference**: Validate against trusted registries

## Error Codes

| Code | Description | Action |
|------|-------------|---------|
| CERT_001 | Invalid JSON structure | Reject certificate |
| CERT_002 | Missing required field | Reject certificate |
| CERT_003 | Invalid signature | Reject certificate |
| CERT_004 | Proof verification failed | Reject certificate |
| CERT_005 | Policy violation | Reject certificate |
| CERT_006 | Certificate expired | Reject certificate |

## Implementation Guidelines

- Certificates must be generated atomically
- All cryptographic operations must use approved algorithms
- Certificates should include sufficient metadata for audit trails
- Consider certificate revocation mechanisms
